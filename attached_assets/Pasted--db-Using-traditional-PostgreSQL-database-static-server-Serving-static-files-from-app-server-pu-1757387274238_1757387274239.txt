[db] Using traditional PostgreSQL database
[static-server] Serving static files from: /app/server/public
[static-server] Static server configured successfully
2:51:58 AM [express] serving on port 5000
[static-server] Serving index.html for: /seja-profissional
2:52:55 AM [express] GET /api/install/status 304 in 30ms :: {"installed":true,"needsInstallation":fa…
[static-server] Serving index.html for: /favicon.ico
2:52:55 AM [express] GET /api/subscription-plans 304 in 16ms :: [{"id":"6e31f402-53a5-4b6d-a1a1-88eb…
Plan found: {
  id: '6e31f402-53a5-4b6d-a1a1-88eb5a3f9e10',
  name: 'Plano Básico',
  monthlyPrice: '29.90',
  monthlyPriceType: 'string',
  pagarmeProductId: 'plan_94qYE4wtxt4jeZ25'
}
Price validation: {
  planName: 'Plano Básico',
  originalPrice: '29.90',
  priceInReais: 29.9,
  priceInCentavos: 2990,
  expectedForProfissional: 'R$ 59,90 = 5990 centavos'
}
Pagar.me subscription response: {
  "id": "sub_JV2EvRzCAtmvyMpW",
  "code": "SUB_75157284187_1757386393307",
  "start_at": "2025-09-08T00:00:00Z",
  "interval": "month",
  "interval_count": 1,
  "billing_type": "prepaid",
  "current_cycle": {
    "id": "cycle_OkYb9kVsZtKenXPQ",
    "start_at": "2025-09-08T00:00:00Z",
    "end_at": "2025-10-07T23:59:59Z",
    "billing_at": "2025-09-08T00:00:00Z",
    "status": "billed",
    "cycle": 1
  },
  "next_billing_at": "2025-10-08T00:00:00Z",
  "payment_method": "boleto",
  "currency": "BRL",
  "statement_descriptor": "MONTE EVEREST",
  "installments": 1,
  "status": "active",
  "created_at": "2025-09-09T02:53:13Z",
  "updated_at": "2025-09-09T02:53:13Z",
  "customer": {
    "id": "cus_3W91ybXi1iRYkaQK",
    "name": "Rafael Miguel de Oliveira",
    "email": "rafaeladapta02@gmail.com",
    "code": "75157284187",
    "document": "75157284187",
    "type": "individual",
    "delinquent": false,
    "address": {
      "id": "addr_VAG040WUQU3zxQ5d",
      "line_1": "Rua Principal, 123",
      "line_2": "Centro",
      "street": "Rua Principal",
      "number": "123",
      "complement": "",
      "zip_code": "74000000",
      "neighborhood": "Centro",
      "city": "Goiânia",
      "state": "GO",
      "country": "BR",
      "status": "active",
      "created_at": "2025-09-09T02:48:34Z",
      "updated_at": "2025-09-09T02:48:34Z"
    },
    "created_at": "2025-09-09T02:48:34Z",
    "updated_at": "2025-09-09T02:48:34Z",
    "phones": {},
    "metadata": {
      "created_by": "monte_everest_system"
    }
  },
  "plan": {
    "id": "plan_94qYE4wtxt4jeZ25",
    "name": "Plano Básico",
    "description": "Plano básico para profissionais",
    "url": "plans/plan_94qYE4wtxt4jeZ25/everest-servicos-ltda-conta-ativa-test/plano-basico",
    "statement_descriptor": "MONTE EVEREST",
    "interval": "month",
    "interval_count": 1,
    "billing_type": "prepaid",
    "payment_methods": [
      "credit_card",
      "boleto"
    ],
    "installments": [
      1,
      2,
      3,
      6,
      12
    ],
    "status": "active",
    "currency": "BRL",
    "created_at": "2025-09-09T02:30:29Z",
    "updated_at": "2025-09-09T02:30:29Z",
    "metadata": {
      "plan_id": "6e31f402-53a5-4b6d-a1a1-88eb5a3f9e10",
      "created_by": "monte_everest_system"
    }
  },
  "items": [
    {
      "id": "si_qedbPdgSXaSl4bPo",
      "name": "Plano Básico",
      "description": "Plano básico para profissionais",
      "quantity": 1,
      "status": "active",
      "created_at": "2025-09-09T02:53:13Z",
      "updated_at": "2025-09-09T02:53:13Z",
      "pricing_scheme": {
        "price": 2990,
        "scheme_type": "unit"
      }
[db] Using traditional PostgreSQL database
[static-server] Serving static files from: /app/server/public
[static-server] Static server configured successfully
2:57:28 AM [express] serving on port 5000
Plan found: {
  id: '0970052b-198b-4ba0-a996-28afb007df73',
  name: 'Plano Premium',
  monthlyPrice: '59.90',
  monthlyPriceType: 'string',
  pagarmeProductId: 'plan_PyxZbvzhYPtGZnYl'
}
Price validation: {
  planName: 'Plano Premium',
  originalPrice: '59.90',
  priceInReais: 59.9,
  priceInCentavos: 5990,
  expectedForProfissional: 'R$ 59,90 = 5990 centavos'
}
Pagar.me subscription response: {
  "id": "sub_87rPDYEhNWurGXk1",
  "code": "SUB_75157284187_1757386662033",
  "start_at": "2025-09-08T00:00:00Z",
  "interval": "month",
  "interval_count": 1,
  "billing_type": "prepaid",
  "current_cycle": {
    "id": "cycle_kJ2rzwFWKS2mlv5G",
    "start_at": "2025-09-08T00:00:00Z",
    "end_at": "2025-10-07T23:59:59Z",
    "billing_at": "2025-09-08T00:00:00Z",
    "status": "billed",
    "cycle": 1
  },
  "next_billing_at": "2025-10-08T00:00:00Z",
  "payment_method": "boleto",
  "currency": "BRL",
  "statement_descriptor": "MONTE EVEREST",
  "installments": 1,
  "status": "active",
  "created_at": "2025-09-09T02:57:42Z",
  "updated_at": "2025-09-09T02:57:42Z",
  "customer": {
    "id": "cus_3W91ybXi1iRYkaQK",
    "name": "Rafael Miguel de Oliveira",
    "email": "rafaeladapta02@gmail.com",
    "code": "75157284187",
    "document": "75157284187",
    "type": "individual",
    "delinquent": false,
    "address": {
      "id": "addr_VAG040WUQU3zxQ5d",
      "line_1": "Rua Principal, 123",
      "line_2": "Centro",
      "street": "Rua Principal",
      "number": "123",
      "complement": "",
      "zip_code": "74000000",
      "neighborhood": "Centro",
      "city": "Goiânia",
      "state": "GO",
      "country": "BR",
      "status": "active",
      "created_at": "2025-09-09T02:48:34Z",
      "updated_at": "2025-09-09T02:48:34Z"
    },
    "created_at": "2025-09-09T02:48:34Z",
    "updated_at": "2025-09-09T02:48:34Z",
    "phones": {},
    "metadata": {
      "created_by": "monte_everest_system"
    }
  },
  "plan": {
    "id": "plan_PyxZbvzhYPtGZnYl",
    "name": "Plano Premium",
    "description": "Plano premium com recursos avançados",
    "url": "plans/plan_PyxZbvzhYPtGZnYl/everest-servicos-ltda-conta-ativa-test/plano-premium",
    "statement_descriptor": "MONTE EVEREST",
    "interval": "month",
    "interval_count": 1,
    "billing_type": "prepaid",
    "payment_methods": [
      "credit_card",
      "boleto"
    ],
    "installments": [
      1,
      2,
      3,
      6,
      12
    ],
    "status": "active",
    "currency": "BRL",
    "created_at": "2025-09-09T02:30:33Z",
    "updated_at": "2025-09-09T02:30:33Z",
    "metadata": {
      "plan_id": "0970052b-198b-4ba0-a996-28afb007df73",
      "created_by": "monte_everest_system"
    }
  },
  "items": [
    {
      "id": "si_6pg8eVpCB3CNomlX",
      "name": "Plano Premium",
      "description": "Plano premium com recursos avançados",
      "quantity": 1,
      "status": "active",
      "created_at": "2025-09-09T02:57:42Z",
      "updated_at": "2025-09-09T02:57:42Z",
      "pricing_scheme": {
        "price": 5990,
        "scheme_type": "unit"
      }
    },
    {
      "id": "0970052b-198b-4ba0-a996-28afb007df73",
      "name": "Plano Premium",
      "description": "Plano premium com recursos avançados",
      "quantity": 1,
      "status": "active",
      "created_at": "2025-09-09T02:57:42Z",
      "updated_at": "2025-09-09T02:57:42Z",
      "pricing_scheme": {
        "price": 5990,
        "scheme_type": "unit"
      }
    }
  ],
  "boleto": {},
  "metadata": {
    "professional_name": "Rafael Miguel de Oliveira",
    "professional_email": "rafaeladapta02@gmail.com",
    "plan_name": "Plano Premium"
  }
}
Error creating subscription: error: duplicate key value violates unique constraint "professionals_email_key"
    at /app/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/app/node_modules/src/node-postgres/session.ts:104:19)
    at async DatabaseStorage.createProfessional (/app/server/storage.ts:426:23)
    at async <anonymous> (/app/server/routes.ts:2302:28) {
  length: 240,
  severity: 'ERROR',
  code: '23505',
  detail: 'Key (email)=(rafaeladapta02@gmail.com) already exists.',
  hint: undefined,
  position: undefined,
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: 'public',
  table: 'professionals',
  column: undefined,
  dataType: undefined,
  constraint: 'professionals_email_key',
  file: 'nbtinsert.c',
  line: '666',
  routine: '_bt_check_unique'
}
2:57:44 AM [express] POST /api/payments/create-subscription 500 in 2143ms :: {"success":false,"error…
[static-server] Serving index.html for: /setup-tables
3:00:07 AM [express] GET /api/install/status 304 in 21ms :: {"installed":true,"needsInstallation":fa…
[static-server] Serving index.html for: /favicon.ico
[setup-tables] Iniciando criação das tabelas...
[auto-installer] ✅ Conexão com banco testada com sucesso
[auto-installer] Iniciando criação automática das tabelas...
[auto-installer] Conectado ao banco PostgreSQL
[auto-installer] Executando SQL de criação das tabelas...
[auto-installer] ✅ Todas as tabelas criadas com sucesso!
[setup-tables] ✅ Tabelas criadas com sucesso!
3:03:52 AM [express] POST /api/setup-tables 200 in 34ms :: {"success":true,"message":"✅ Todas as tab…
[static-server] Serving index.html for: /install
3:03:55 AM [express] GET /api/install/status 304 in 11ms :: {"installed":true,"needsInstallation":fa…
[static-server] Serving index.html for: /favicon.ico
[static-server] Serving index.html for: /favicon.ico
3:03:57 AM [express] GET /api/categories 304 in 26ms :: [{"id":"ae882751-68f1-41de-987b-05bb9262cb97…
3:03:57 AM [express] GET /api/professionals/search 304 in 19ms :: []
3:03:57 AM [express] GET /api/categories/popular 304 in 16ms :: [{"id":"676b8100-d29b-4890-b1ea-e6f7…
3:04:00 AM [express] GET /api/subscription-plans 200 in 4ms :: [{"id":"7e6d27e8-32ab-45fe-bcf6-96942…
[static-server] Serving index.html for: /favicon.ico
[static-server] Serving index.html for: /seja-profissional
3:04:25 AM [express] GET /api/install/status 304 in 22ms :: {"installed":true,"needsInstallation":fa…
[static-server] Serving index.html for: /favicon.ico
3:04:25 AM [express] GET /api/subscription-plans 304 in 13ms :: [{"id":"7e6d27e8-32ab-45fe-bcf6-9694…
[db] Using traditional PostgreSQL database
[static-server] Serving static files from: /app/server/public
[static-server] Static server configured successfully
3:04:29 AM [express] serving on port 5000
[static-server] Serving index.html for: /entrar
[static-server] Serving index.html for: /favicon.ico
3:04:35 AM [express] GET /api/install/status 304 in 31ms :: {"installed":true,"needsInstallation":fa…
3:04:41 AM [express] POST /api/auth/admin/login 200 in 74ms :: {"token":"eyJhbGciOiJIUzI1NiIsInR5cCI…
3:04:41 AM [express] GET /api/admin/dashboard/stats 304 in 23ms :: {"activeProfessionals":0,"monthly…
3:04:41 AM [express] GET /api/admin/plans 200 in 8ms :: [{"id":"7e6d27e8-32ab-45fe-bcf6-969427e9767c…
[static-server] Serving index.html for: /favicon.ico
3:04:41 AM [express] GET /api/admin/configs/PAGARME_API_KEY 304 in 11ms :: {"id":"3554ad96-72b0-4cfc…
3:04:41 AM [express] GET /api/admin/configs/PAGARME_ENCRYPTION_KEY 304 in 57ms :: {"id":"b8c33f3f-e0…
3:04:41 AM [express] GET /api/admin/pages 304 in 64ms :: [{"id":"7c3e611b-acf5-4db8-b2d5-e8226510005…
3:04:41 AM [express] GET /api/admin/users 304 in 68ms :: [{"id":"85890426-9dd2-4b67-b8a0-50de8fb4fd0…
3:04:41 AM [express] GET /api/admin/professionals 304 in 78ms :: [{"id":"d2617323-23ea-481a-81b9-13f…
3:04:41 AM [express] GET /api/admin/reviews 200 in 58ms :: [{"id":"957c8d95-4bb0-48e2-985b-28274e5b6…
3:04:41 AM [express] GET /api/admin/payments 304 in 76ms :: []
3:04:41 AM [express] GET /api/admin/categories 304 in 54ms :: [{"id":"ae882751-68f1-41de-987b-05bb92…
3:04:52 AM [express] DELETE /api/admin/plans/f5a52cde-9c5f-4bae-a5dd-f0020f0844a9 200 in 17ms :: {"m…
3:04:52 AM [express] GET /api/admin/plans 200 in 5ms :: [{"id":"7e6d27e8-32ab-45fe-bcf6-969427e9767c…
3:04:55 AM [express] DELETE /api/admin/plans/7e6d27e8-32ab-45fe-bcf6-969427e9767c 200 in 6ms :: {"me…
3:04:55 AM [express] GET /api/admin/plans 200 in 4ms :: [{"id":"6e31f402-53a5-4b6d-a1a1-88eb5a3f9e10…
3:05:17 AM [express] PATCH /api/admin/professionals/d2617323-23ea-481a-81b9-13f331f78b5a/status 200 …
3:05:17 AM [express] GET /api/admin/dashboard/stats 200 in 7ms :: {"activeProfessionals":1,"monthlyR…
3:05:17 AM [express] GET /api/admin/professionals 200 in 13ms :: [{"id":"d2617323-23ea-481a-81b9-13f…
[static-server] Serving index.html for: /favicon.ico
[static-server] Serving index.html for: /favicon.ico
3:05:32 AM [express] GET /api/subscription-plans 200 in 12ms :: [{"id":"6e31f402-53a5-4b6d-a1a1-88eb…
[static-server] Serving index.html for: /favicon.ico
3:05:34 AM [express] GET /api/categories 304 in 3ms :: [{"id":"ae882751-68f1-41de-987b-05bb9262cb97"…
3:05:34 AM [express] GET /api/categories/popular 304 in 4ms :: [{"id":"676b8100-d29b-4890-b1ea-e6f76…
3:05:34 AM [express] GET /api/professionals/search 200 in 12ms :: [{"id":"d2617323-23ea-481a-81b9-13…
[static-server] Serving index.html for: /favicon.ico
[static-server] Serving index.html for: /favicon.ico
[static-server] Serving index.html for: /favicon.ico
Plan found: {
  id: '6e31f402-53a5-4b6d-a1a1-88eb5a3f9e10',
  name: 'Plano Básico',
  monthlyPrice: '29.90',
  monthlyPriceType: 'string',
  pagarmeProductId: 'plan_94qYE4wtxt4jeZ25'
}
Price validation: {
  planName: 'Plano Básico',
  originalPrice: '29.90',
  priceInReais: 29.9,
  priceInCentavos: 2990,
  expectedForProfissional: 'R$ 59,90 = 5990 centavos'
}
Pagar.me subscription response: {
  "id": "sub_wj81kPKIlIxQy45e",
  "code": "SUB_70515410136_1757387182635",
  "start_at": "2025-09-09T00:00:00Z",
  "interval": "month",
  "interval_count": 1,
  "billing_type": "prepaid",
  "current_cycle": {
    "id": "cycle_pRkmOdjiBix03Yrg",
    "start_at": "2025-09-09T00:00:00Z",
    "end_at": "2025-10-08T23:59:59Z",
    "billing_at": "2025-09-09T00:00:00Z",
    "status": "billed",
    "cycle": 1
  },
  "next_billing_at": "2025-10-09T00:00:00Z",
  "payment_method": "boleto",
  "currency": "BRL",
  "statement_descriptor": "MONTE EVEREST",
  "installments": 1,
  "status": "active",
  "created_at": "2025-09-09T03:06:23Z",
  "updated_at": "2025-09-09T03:06:23Z",
  "customer": {
    "id": "cus_72zoGKjCKCWOnkmp",
    "name": "Teste Dois",
    "email": "rafaeladapta01@gmail.com",
    "code": "70515410136",
    "document": "70515410136",
    "type": "individual",
    "delinquent": false,
    "address": {
      "id": "addr_Xwdl2R3h8hEk3Gz5",
      "line_1": "Rua Principal, 123",
      "line_2": "Centro",
      "street": "Rua Principal",
      "number": "123",
      "complement": "",
      "zip_code": "74000000",
      "neighborhood": "Centro",
      "city": "Goiânia",
      "state": "GO",
      "country": "BR",
      "status": "active",
      "created_at": "2025-09-04T14:31:22Z",
      "updated_at": "2025-09-09T03:06:23Z"
    },
    "created_at": "2025-09-04T14:31:22Z",
    "updated_at": "2025-09-09T03:06:23Z",
    "phones": {},
    "metadata": {
      "created_by": "monte_everest_system"
    }
  },
  "plan": {
    "id": "plan_94qYE4wtxt4jeZ25",
    "name": "Plano Básico",
    "description": "Plano básico para profissionais",
    "url": "plans/plan_94qYE4wtxt4jeZ25/everest-servicos-ltda-conta-ativa-test/plano-basico",
    "statement_descriptor": "MONTE EVEREST",
    "interval": "month",
    "interval_count": 1,
    "billing_type": "prepaid",
    "payment_methods": [
      "credit_card",
      "boleto"
    ],
    "installments": [
      1,
      2,
      3,
      6,
      12
    ],
    "status": "active",
    "currency": "BRL",
    "created_at": "2025-09-09T02:30:29Z",
    "updated_at": "2025-09-09T02:30:29Z",
    "metadata": {
      "plan_id": "6e31f402-53a5-4b6d-a1a1-88eb5a3f9e10",
      "created_by": "monte_everest_system"
    }
  },
  "items": [
    {
      "id": "si_oyW54mltvt7xYrRZ",
      "name": "Plano Básico",
      "description": "Plano básico para profissionais",
      "quantity": 1,
      "status": "active",
      "created_at": "2025-09-09T03:06:23Z",
      "updated_at": "2025-09-09T03:06:23Z",
      "pricing_scheme": {
        "price": 2990,
        "scheme_type": "unit"
      }
    },
    {
      "id": "6e31f402-53a5-4b6d-a1a1-88eb5a3f9e10",
      "name": "Plano Básico",
      "description": "Plano básico para profissionais",
      "quantity": 1,
      "status": "active",
      "created_at": "2025-09-09T03:06:23Z",
      "updated_at": "2025-09-09T03:06:23Z",
      "pricing_scheme": {
        "price": 2990,
        "scheme_type": "unit"
      }
    }
  ],
  "boleto": {},
  "metadata": {
    "professional_name": "Teste Dois",
    "professional_email": "rafaeladapta01@gmail.com",
    "plan_name": "Plano Básico"
  }
}
Error creating subscription: error: column "card_token" of relation "payments" does not exist
    at /app/node_modules/pg-pool/index.js:45:11
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async <anonymous> (/app/node_modules/src/node-postgres/session.ts:104:19)
    at async DatabaseStorage.createPayment (/app/server/storage.ts:555:23)
    at async <anonymous> (/app/server/routes.ts:2318:23) {
  length: 132,
  severity: 'ERROR',
  code: '42703',
  detail: undefined,
  hint: undefined,
  position: '156',
  internalPosition: undefined,
  internalQuery: undefined,
  where: undefined,
  schema: undefined,
  table: undefined,
  column: undefined,
  dataType: undefined,
  constraint: undefined,
  file: 'parse_target.c',
  line: '1065',
  routine: 'checkInsertTargets'
}
3:06:25 AM [express] POST /api/payments/create-subscription 500 in 2693ms :: {"success":false,"error…
[db] Using traditional PostgreSQL database
[static-server] Serving static files from: /app/server/public
[static-server] Static server configured successfully
3:06:42 AM [express] serving on port 5000